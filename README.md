# Filmorate
ГРУППОВОЙ ПРОЕКТ.<br>
В разработке участвовали:
- [Новикова Надежда](https://github.com/NadezhdaNovikova) 
- [Сафиулин Роман](https://github.com/SafiulinRM)
- [Павел Ковалев](https://github.com/M0L0D0Y)
- [Кленин Арсений](https://github.com/klenars) <br>

Бэкенд для сервиса, который работает с фильмами, пользователями, их отзывами
 и оценками на фильмы и отзывы.
Программа может принимать, обновлять и возвращать пользователей и фильмы.
Дает возможность пользователям добавлять друг друга в друзья и ставить фильмам лайки.

#### Функциональность «Отзывы».
Добавленные отзывы имеют рейтинг и несколько дополнительных характеристик.

1. Оценка — полезно/бесполезно.
2. Тип отзыва — негативный/положительный.

У отзыва имеется рейтинг. При создании отзыва рейтинг равен нулю. Если пользователь оценил отзыв как полезный, это увеличивает его рейтинг на 1. Если как бесполезный, то уменьшает на 1.
Отзывы сортируются по рейтингу полезности.

#### Функциональность «Поиск».
Реализован поиск по названию фильмов и по режиссёру.
Алгоритм умеет искать по подстроке. Например, вы вводите ****«****крад****»****, а в поиске возвращаются следующие фильмы: 
****«****Крадущийся тигр, затаившийся дракон****»****, ****«****Крадущийся в ночи****»**** и другие.

#### Функциональность «Общие фильмы».
Реализован вывод общих с другом фильмов с сортировкой по их популярности.

#### Функциональность «Рекомендации».
Реализована простая рекомендательная система для фильмов. Примерный алгоритм выглядит следующим образом:
1. Найти пользователей с максимальным количеством пересечения по лайкам.
2. Определить фильмы, которые один пролайкал, а другой нет.
3. Рекомендовать фильмы, которым поставил лайк пользователь с похожими вкусами, а тот, для кого составляется рекомендация, ещё не поставил.

#### Функциональность «Лента событий».
Добавлена возможность просмотра последних событий на платформе — добавление в друзья, удаление из друзей, лайки и отзывы, которые оставили друзья пользователя.

#### Функциональность «Популярные фильмы».
Предусматривает вывод самых любимых у зрителей фильмов по жанрам и годам.

#### Функциональность «Фильмы по режиссёрам».
Предполагает добавление к фильму информации о его режиссёре.


### Диаграмма БД:

![](db/QuickDBD.png)

### Taблица ***film***.
Содержит информацию о фильмах.
Пример запроса на получение:

*SELECT * 
FROM film 
WHERE film_id = ?*

### Taблица ***user***.
Содержит информацию о пользователях.
Пример запроса на получение:

*SELECT *
FROM user
WHERE film_id = ?*

### Taблица ***genre***.
Содержит информацию о жанрах фильмов.
Пример запроса на получение всех жанров:

*SELECT *
FROM genre*

### Taблица ***mpa***.
Содержит информацию о возрастных рейтигах для фильма.
Пример запроса на получение всех рейтингов:

*SELECT *
FROM mpa*

### Taблица ***film_genre***.
Содержит информацию о фильмах и их жанрах.
Пример запроса на получение всех жанров конкретного фильма:

*SELECT *
FROM genre AS g 
LEFT JOIN film_genre AS fg ON g.genre_id = fg.genre_id
WHERE fg.film_id = ?
ORDER BY g.genre_id*

### Taблица ***user_friend***.
Содержит информацию о дружбе между пользователями.
Пример запроса на получение списка друзей юзера:

*SELECT *
FROM users AS u
LEFT JOIN user_friend AS uf ON u.user_id = uf.friend_id
WHERE uf.user_id = ?*

### Taблица ***film_user_like***.
Содержит информацию лайках поставленных юзерами фильмам.
Пример запроса на получение списка самых популярных фильмов отсортированный
по убыванию колличества лайков и огранниченный колличеством строк:

*SELECT *
FROM film AS f
LEFT JOIN film_user_like AS ful ON f.film_id = ful.film_id
GROUP BY f.film_id
ORDER BY COUNT(ful.user_id) DESC
LIMIT ?*